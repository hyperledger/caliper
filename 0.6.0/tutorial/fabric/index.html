<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=../ rel=prev><link rel=icon href=../../_static/caliper.svg><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.5.28"><title>Basic Fabric Tutorial - Hyperledger Caliper</title><link rel=stylesheet href=../../assets/stylesheets/main.6543a935.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script><script id=__analytics>function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config",""),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script><script>"undefined"!=typeof __md_analytics&&__md_analytics()</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#overview class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <div data-md-color-scheme=default data-md-component=outdated hidden> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Hyperledger Caliper" class="md-header__button md-logo" aria-label="Hyperledger Caliper" data-md-component=logo> <img src=../../_static/caliper.svg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Hyperledger Caliper </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Basic Fabric Tutorial </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=indigo data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <a href=javascript:void(0) class="md-search__icon md-icon" title=Share aria-label=Share data-clipboard data-clipboard-text data-md-component=search-share tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg> </a> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/hyperledger-caliper/caliper title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> hyperledger/caliper </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Getting Started </a> </li> <li class=md-tabs__item> <a href=../../concepts/bench-config/ class=md-tabs__link> Concepts </a> </li> <li class=md-tabs__item> <a href=../../connectors/fabric-config/ class=md-tabs__link> Connectors </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../ class=md-tabs__link> Tutorials </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Hyperledger Caliper" class="md-nav__button md-logo" aria-label="Hyperledger Caliper" data-md-component=logo> <img src=../../_static/caliper.svg alt=logo> </a> Hyperledger Caliper </label> <div class=md-nav__source> <a href=https://github.com/hyperledger-caliper/caliper title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </div> <div class=md-source__repository> hyperledger/caliper </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1> <div class="md-nav__link md-nav__container"> <a href=../.. class="md-nav__link "> <span class=md-ellipsis> Getting Started </span> </a> <label class="md-nav__link " for=__nav_1 id=__nav_1_label tabindex=0> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=false> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Getting Started </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../getting-started/installing-caliper/ class=md-nav__link> <span class=md-ellipsis> Installing and Running Caliper </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/architecture/ class=md-nav__link> <span class=md-ellipsis> Architecture </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/contributing/ class=md-nav__link> <span class=md-ellipsis> Contributing </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/faq/ class=md-nav__link> <span class=md-ellipsis> FAQ </span> </a> </li> <li class=md-nav__item> <a href=../../getting-started/license/ class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Concepts </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Concepts </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../concepts/bench-config/ class=md-nav__link> <span class=md-ellipsis> Benchmark Configuration </span> </a> </li> <li class=md-nav__item> <a href=../../concepts/workload-module/ class=md-nav__link> <span class=md-ellipsis> Workload Configuration </span> </a> </li> <li class=md-nav__item> <a href=../../concepts/rate-controllers/ class=md-nav__link> <span class=md-ellipsis> Rate Controllers </span> </a> </li> <li class=md-nav__item> <a href=../../concepts/caliper-monitors/ class=md-nav__link> <span class=md-ellipsis> Resource and Transaction Monitors </span> </a> </li> <li class=md-nav__item> <a href=../../concepts/caliper-messengers/ class=md-nav__link> <span class=md-ellipsis> Messengers </span> </a> </li> <li class=md-nav__item> <a href=../../concepts/runtime-config/ class=md-nav__link> <span class=md-ellipsis> Runtime Configuration </span> </a> </li> <li class=md-nav__item> <a href=../../concepts/logging-control/ class=md-nav__link> <span class=md-ellipsis> Logging Control </span> </a> </li> <li class=md-nav__item> <a href=../../concepts/benchmark-generators/ class=md-nav__link> <span class=md-ellipsis> Benchmark Generators </span> </a> </li> <li class=md-nav__item> <a href=../../concepts/declarative-workload-module/ class=md-nav__link> <span class=md-ellipsis> Declarative Workloads </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Connectors </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Connectors </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../connectors/fabric-config/ class=md-nav__link> <span class=md-ellipsis> Fabric </span> </a> </li> <li class=md-nav__item> <a href=../../connectors/ethereum-config/ class=md-nav__link> <span class=md-ellipsis> Ethereum </span> </a> </li> <li class=md-nav__item> <a href=../../connectors/writing-connectors/ class=md-nav__link> <span class=md-ellipsis> Writing Connectors </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4 checked> <div class="md-nav__link md-nav__container"> <a href=../ class="md-nav__link "> <span class=md-ellipsis> Tutorials </span> </a> <label class="md-nav__link " for=__nav_4 id=__nav_4_label tabindex> <span class="md-nav__icon md-icon"></span> </label> </div> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=true> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Tutorials </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Basic Fabric Tutorial </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Basic Fabric Tutorial </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#step-1-create-a-caliper-workspace class=md-nav__link> <span class=md-ellipsis> Step 1 - Create a Caliper Workspace </span> </a> </li> <li class=md-nav__item> <a href=#step-2-build-a-network-configuration-file class=md-nav__link> <span class=md-ellipsis> Step 2 - Build a Network Configuration File </span> </a> <nav class=md-nav aria-label="Step 2 - Build a Network Configuration File"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#create-a-template-network-configuration-file class=md-nav__link> <span class=md-ellipsis> Create a Template Network Configuration File </span> </a> </li> <li class=md-nav__item> <a href=#a-brief-introduction-to-common-connection-profiles-ccp class=md-nav__link> <span class=md-ellipsis> A brief introduction to Common Connection Profiles (CCP) </span> </a> </li> <li class=md-nav__item> <a href=#populating-the-template-file class=md-nav__link> <span class=md-ellipsis> Populating The Template File </span> </a> <nav class=md-nav aria-label="Populating The Template File"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#organizations class=md-nav__link> <span class=md-ellipsis> Organizations </span> </a> </li> <li class=md-nav__item> <a href=#channels class=md-nav__link> <span class=md-ellipsis> Channels </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#the-complete-network-configuration-file class=md-nav__link> <span class=md-ellipsis> The Complete Network Configuration File </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#step-3-build-a-test-workload-module class=md-nav__link> <span class=md-ellipsis> Step 3 - Build a Test Workload Module </span> </a> <nav class=md-nav aria-label="Step 3 - Build a Test Workload Module"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#create-a-template-workload-module class=md-nav__link> <span class=md-ellipsis> Create A Template Workload Module </span> </a> </li> <li class=md-nav__item> <a href=#populating-the-template-file_1 class=md-nav__link> <span class=md-ellipsis> Populating the Template File </span> </a> <nav class=md-nav aria-label="Populating the Template File"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#populate-initializeworkloadmodule class=md-nav__link> <span class=md-ellipsis> Populate initializeWorkloadModule </span> </a> </li> <li class=md-nav__item> <a href=#populate-submittransaction class=md-nav__link> <span class=md-ellipsis> Populate submitTransaction </span> </a> </li> <li class=md-nav__item> <a href=#populate-cleanupworkloadmodule class=md-nav__link> <span class=md-ellipsis> Populate cleanupWorkloadModule </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#the-complete-workload-module class=md-nav__link> <span class=md-ellipsis> The Complete Workload Module </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#step-4-build-a-benchmark-configuration-file class=md-nav__link> <span class=md-ellipsis> Step 4 - Build a Benchmark Configuration File </span> </a> <nav class=md-nav aria-label="Step 4 - Build a Benchmark Configuration File"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#create-a-template-benchmark-configuration-file class=md-nav__link> <span class=md-ellipsis> Create A Template Benchmark Configuration File </span> </a> </li> <li class=md-nav__item> <a href=#populating-the-template-file_2 class=md-nav__link> <span class=md-ellipsis> Populating the Template File </span> </a> <nav class=md-nav aria-label="Populating the Template File"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#populate-workers class=md-nav__link> <span class=md-ellipsis> Populate Workers </span> </a> </li> <li class=md-nav__item> <a href=#populate-rounds class=md-nav__link> <span class=md-ellipsis> Populate Rounds </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#the-complete-benchmark-configuration-file class=md-nav__link> <span class=md-ellipsis> The Complete Benchmark Configuration File </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#step-5-run-the-caliper-benchmark class=md-nav__link> <span class=md-ellipsis> Step 5 - Run the Caliper Benchmark </span> </a> <nav class=md-nav aria-label="Step 5 - Run the Caliper Benchmark"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#run-the-command class=md-nav__link> <span class=md-ellipsis> Run the command </span> </a> </li> <li class=md-nav__item> <a href=#benchmark-results class=md-nav__link> <span class=md-ellipsis> Benchmark Results </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#license class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#step-1-create-a-caliper-workspace class=md-nav__link> <span class=md-ellipsis> Step 1 - Create a Caliper Workspace </span> </a> </li> <li class=md-nav__item> <a href=#step-2-build-a-network-configuration-file class=md-nav__link> <span class=md-ellipsis> Step 2 - Build a Network Configuration File </span> </a> <nav class=md-nav aria-label="Step 2 - Build a Network Configuration File"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#create-a-template-network-configuration-file class=md-nav__link> <span class=md-ellipsis> Create a Template Network Configuration File </span> </a> </li> <li class=md-nav__item> <a href=#a-brief-introduction-to-common-connection-profiles-ccp class=md-nav__link> <span class=md-ellipsis> A brief introduction to Common Connection Profiles (CCP) </span> </a> </li> <li class=md-nav__item> <a href=#populating-the-template-file class=md-nav__link> <span class=md-ellipsis> Populating The Template File </span> </a> <nav class=md-nav aria-label="Populating The Template File"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#organizations class=md-nav__link> <span class=md-ellipsis> Organizations </span> </a> </li> <li class=md-nav__item> <a href=#channels class=md-nav__link> <span class=md-ellipsis> Channels </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#the-complete-network-configuration-file class=md-nav__link> <span class=md-ellipsis> The Complete Network Configuration File </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#step-3-build-a-test-workload-module class=md-nav__link> <span class=md-ellipsis> Step 3 - Build a Test Workload Module </span> </a> <nav class=md-nav aria-label="Step 3 - Build a Test Workload Module"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#create-a-template-workload-module class=md-nav__link> <span class=md-ellipsis> Create A Template Workload Module </span> </a> </li> <li class=md-nav__item> <a href=#populating-the-template-file_1 class=md-nav__link> <span class=md-ellipsis> Populating the Template File </span> </a> <nav class=md-nav aria-label="Populating the Template File"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#populate-initializeworkloadmodule class=md-nav__link> <span class=md-ellipsis> Populate initializeWorkloadModule </span> </a> </li> <li class=md-nav__item> <a href=#populate-submittransaction class=md-nav__link> <span class=md-ellipsis> Populate submitTransaction </span> </a> </li> <li class=md-nav__item> <a href=#populate-cleanupworkloadmodule class=md-nav__link> <span class=md-ellipsis> Populate cleanupWorkloadModule </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#the-complete-workload-module class=md-nav__link> <span class=md-ellipsis> The Complete Workload Module </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#step-4-build-a-benchmark-configuration-file class=md-nav__link> <span class=md-ellipsis> Step 4 - Build a Benchmark Configuration File </span> </a> <nav class=md-nav aria-label="Step 4 - Build a Benchmark Configuration File"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#create-a-template-benchmark-configuration-file class=md-nav__link> <span class=md-ellipsis> Create A Template Benchmark Configuration File </span> </a> </li> <li class=md-nav__item> <a href=#populating-the-template-file_2 class=md-nav__link> <span class=md-ellipsis> Populating the Template File </span> </a> <nav class=md-nav aria-label="Populating the Template File"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#populate-workers class=md-nav__link> <span class=md-ellipsis> Populate Workers </span> </a> </li> <li class=md-nav__item> <a href=#populate-rounds class=md-nav__link> <span class=md-ellipsis> Populate Rounds </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#the-complete-benchmark-configuration-file class=md-nav__link> <span class=md-ellipsis> The Complete Benchmark Configuration File </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#step-5-run-the-caliper-benchmark class=md-nav__link> <span class=md-ellipsis> Step 5 - Run the Caliper Benchmark </span> </a> <nav class=md-nav aria-label="Step 5 - Run the Caliper Benchmark"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#run-the-command class=md-nav__link> <span class=md-ellipsis> Run the command </span> </a> </li> <li class=md-nav__item> <a href=#benchmark-results class=md-nav__link> <span class=md-ellipsis> Benchmark Results </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#license class=md-nav__link> <span class=md-ellipsis> License </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>Basic Fabric Tutorial</h1> <h2 id=overview>Overview<a class=headerlink href=#overview title="Permanent link">&para;</a></h2> <p>This tutorial takes you through performance testing a smart contract on a pre-existing Fabric network using Caliper.</p> <p>To complete this tutorial you will need to have installed NodeJS. To do this, we recommend using <a href=https://github.com/nvm-sh/nvm>nvm</a>.</p> <p>This tutorial is based on resources available from the official <a href=https://hyperledger-fabric.readthedocs.io/en/release-2.5/tutorials.html>Hyperledger Fabric documentation</a>. A network comprised of two organizations and a solo orderer, with the javascript <code>asset-transfer-basic</code> smart contract, is assumed to be built and ready to performance test.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p><em>The following command list is a minimalist quick step guide to get the required Fabric network up and running</em>. <strong><em>We use available Hyperledger Fabric resources at explicit levels. To understand and troubleshoot what occurs during the creation of the test network, please refer to the Fabric documentation linked above!</em></strong></p> </div> <p>Ensure you have the following pre-reqs installed</p> <ul> <li>docker engine or docker desktop</li> <li>curl</li> <li>jq</li> <li>a supported node LTS version. a list current supported LTS versions can be found on the <a href=https://nodejs.org/ >node.js website</a> (to install node easily you can use the nvm tool found <a href=https://github.com/nvm-sh/nvm>here</a>) </li> </ul> <div class="language-sh highlight"><pre><span></span><code><span id=__span-0-1><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=c1># Pull down the 2.5.7 hyperledger fabric and 1.5.10 hyperledger fabric ca images/binaries</span>
</span><span id=__span-0-2><a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>curl<span class=w> </span>-sSL<span class=w> </span>https://raw.githubusercontent.com/hyperledger/fabric/main/scripts/bootstrap.sh<span class=w> </span><span class=p>|</span><span class=w> </span>bash<span class=w> </span>-s<span class=w> </span>--<span class=w> </span><span class=m>2</span>.5.7<span class=w> </span><span class=m>1</span>.5.10
</span><span id=__span-0-3><a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=nb>cd</span><span class=w> </span>fabric-samples
</span><span id=__span-0-4><a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=c1># As fabric-samples for hyperledger 2.5 is via the main branch, fix to a specific commit which we know works</span>
</span><span id=__span-0-5><a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=c1># to protect against potential breaking changes in main</span>
</span><span id=__span-0-6><a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>git<span class=w> </span>checkout<span class=w> </span>c691cf94a99372e0225927d7927b1bc367018029
</span><span id=__span-0-7><a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=c1># Start up the test-network</span>
</span><span id=__span-0-8><a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=nb>cd</span><span class=w> </span>test-network/
</span><span id=__span-0-9><a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a>./network.sh<span class=w> </span>up<span class=w> </span>createChannel
</span><span id=__span-0-10><a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a>./network.sh<span class=w> </span>deployCC<span class=w> </span>-ccn<span class=w> </span>basic<span class=w> </span>-ccp<span class=w> </span>../asset-transfer-basic/chaincode-javascript<span class=w> </span>-ccl<span class=w> </span>javascript
</span></code></pre></div> <h2 id=step-1-create-a-caliper-workspace>Step 1 - Create a Caliper Workspace<a class=headerlink href=#step-1-create-a-caliper-workspace title="Permanent link">&para;</a></h2> <p>Create a folder named <strong>caliper-workspace</strong> at the same level as the <strong>fabric-samples</strong> directory, and then within the <strong>caliper-workspace</strong> folder, create three folders named <strong>networks</strong>, <strong>benchmarks</strong>, and <strong>workload</strong> respectively</p> <p>Caliper installation and use will be based on a local npm installation. Within the <strong>caliper-workspace</strong> directory, install caliper CLI using the following terminal command:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-1-1><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a>npm<span class=w> </span>install<span class=w> </span>--only<span class=o>=</span>prod<span class=w> </span>@hyperledger/caliper-cli@0.6.0
</span></code></pre></div> <p>Bind the SDK using the following terminal command:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-2-1><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a>npx<span class=w> </span>caliper<span class=w> </span><span class=nb>bind</span><span class=w> </span>--caliper-bind-sut<span class=w> </span>fabric:fabric-gateway
</span></code></pre></div> <p>Further information relating to the installation and binding of Caliper may be found within the relevant documentation pages.</p> <p>Caliper requires two configuration files:</p> <ul> <li>The network configuration file, which describes the network under test and provides the test identities to use.</li> <li>The benchmark file, which defines the performance test to be completed via a sequenced set of test rounds, each specifying a workload module and a series of options to drive the workload over a time interval.</li> </ul> <p>We will now populate these folders with the assets required by Caliper.</p> <h2 id=step-2-build-a-network-configuration-file>Step 2 - Build a Network Configuration File<a class=headerlink href=#step-2-build-a-network-configuration-file title="Permanent link">&para;</a></h2> <p>The network configuration file is the file required by Caliper workers to be able to submit and evaluate transactions on a Hyperledger Fabric network. The file can be in YAML or JSON format, this tutorial shows the YAML format.</p> <h3 id=create-a-template-network-configuration-file>Create a Template Network Configuration File<a class=headerlink href=#create-a-template-network-configuration-file title="Permanent link">&para;</a></h3> <p>Under the <strong>networks</strong> folder create a template file called <strong>networkConfig.yaml</strong> with the following content:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-3-1><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a>name:<span class=w> </span>Caliper<span class=w> </span><span class=nb>test</span>
</span><span id=__span-3-2><a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>version:<span class=w> </span><span class=s2>&quot;2.0.0&quot;</span>
</span><span id=__span-3-3><a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>
</span><span id=__span-3-4><a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a>caliper:
</span><span id=__span-3-5><a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=w>  </span>blockchain:<span class=w> </span>fabric
</span><span id=__span-3-6><a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a>
</span><span id=__span-3-7><a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a>channels:
</span><span id=__span-3-8><a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a>
</span><span id=__span-3-9><a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a>organizations:
</span></code></pre></div> <p><strong>name</strong>: The name for the configuration, in this instance “Caliper test”.</p> <p><strong>version</strong>: The version of the configuration file being used. “2.0.0” ensures the new fabric connectors are used</p> <p><strong>caliper</strong>: Indicates to Caliper the SUT that is being targeted, and may contain additional start/end commands or sut specific options that are not required within this tutorial. For the purposes of this tutorial, we are targeting a fabric network.</p> <p><strong>channels</strong>: Describes the Hyperledger Fabric channels and the smart contracts deployed on these channels to be benchmarked.</p> <p><strong>organizations</strong>: A list of the Hyperledger Fabric organizations with identities and connection profiles associated with each organization</p> <h3 id=a-brief-introduction-to-common-connection-profiles-ccp>A brief introduction to Common Connection Profiles (CCP)<a class=headerlink href=#a-brief-introduction-to-common-connection-profiles-ccp title="Permanent link">&para;</a></h3> <p>Common Connection Profiles are a file format by which all the Hyperledger Fabric SDKs can use to connect to a Hyperledger Fabric Network. As Caliper utilizes the fabric node sdk to connect to the network, caliper makes use of these connection profiles. Whoever is responsible for building a Hyperledger Fabric network should create these files.</p> <p>A Common Connection Profile will be organization specific. So each organization will have their own unique file. Again the network provider should provide a file for each organization.</p> <p>These profiles can come in 2 forms termed <code>static</code> or <code>dynamic</code> in the Hyperledger Fabric documentation. In summary static connection profiles contain all the information up front about the fabric network. It contains, amongst other things, all the peers, orderers and channels that exist. A <code>dynamic</code> connection profile is minimal usually containing just 1 or 2 peers of your organization for which the SDK will need to use discovery with in order to determine all the required information to be able to interact with the fabric network.</p> <p>You will see that the <code>test-network</code> in fabric samples provides common connection profiles for each organization, and that they are dynamic connection profiles.</p> <h3 id=populating-the-template-file>Populating The Template File<a class=headerlink href=#populating-the-template-file title="Permanent link">&para;</a></h3> <p>Following the test-network tutorial, a Common Connection Profile is generated as well as a set of identities for each organization.</p> <p>We will be using Org1 whose MSP id is <code>Org1MSP</code>to connect in this example, so there is no need to provide details about Org2 which is part of the test-network. Only having to provide a single organization is a very common pattern.</p> <h4 id=organizations>Organizations<a class=headerlink href=#organizations title="Permanent link">&para;</a></h4> <p>Here we need to add information about the organization whose MSP id is <code>Org1MSP</code>. We need to provide a name, it’s associated connection profile and at least 1 identity.</p> <p>The connection profile can be found in <strong>fabric-samples -&gt; test-network -&gt; organizations -&gt; peerOrganizations -&gt; org1.example.com</strong>. There are both json and yaml versions of this file, we will make use of <strong>connection-org1.yaml</strong>. These connection profiles are what Hyperledger Fabric refer to as dynamic so they are expected to be used in conjunction with discovery, therefore we need to declare that this connection profile requires the use of discovery.</p> <p>The identity we will use will be <code>User1@org1.example.com</code>.</p> <p>The private key can be found in <strong>fabric-samples -&gt; test-network -&gt; organizations -&gt; peerOrganizations -&gt; org1.example.com -&gt; users -&gt; User1 -&gt; msp -&gt; keystore -&gt; priv_sk</strong></p> <p>The public certificate can be found in <strong>fabric-samples -&gt; test-network -&gt; organizations -&gt; peerOrganizations -&gt; org1.example.com -&gt; users -&gt; User1 -&gt; msp -&gt; signedcerts -&gt; <a href=mailto:User1@org1.example.com-cert.pem>&#85;&#115;&#101;&#114;&#49;&#64;&#111;&#114;&#103;&#49;&#46;&#101;&#120;&#97;&#109;&#112;&#108;&#101;&#46;&#99;&#111;&#109;&#45;&#99;&#101;&#114;&#116;&#46;&#112;&#101;&#109;</a></strong></p> <p>The identity will need to be given a unique name within the organization. It doesn’t have to match the name that the <code>test-network</code> has used, ie <code>User1@org1.example.com</code> so to keep it simple let’s just give it a name of <code>User1</code>. For the purposes of this tutorial we will just point to the certificate and private key files, but it’s also possible to embed the information directly into the network configuration file.</p> <p>Below is the required organizations section that provides the above detail</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-4-1><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a>organizations:
</span><span id=__span-4-2><a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=w>  </span>-<span class=w> </span>mspid:<span class=w> </span>Org1MSP
</span><span id=__span-4-3><a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=w>    </span>identities:
</span><span id=__span-4-4><a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a><span class=w>      </span>certificates:
</span><span id=__span-4-5><a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=w>      </span>-<span class=w> </span>name:<span class=w> </span><span class=s1>&#39;User1&#39;</span>
</span><span id=__span-4-6><a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=w>        </span>clientPrivateKey:
</span><span id=__span-4-7><a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a><span class=w>          </span>path:<span class=w> </span><span class=s1>&#39;../fabric-samples/test-network/organizations/peerOrganizations/org1.example.com/users/User1@org1.example.com/msp/keystore/priv_sk&#39;</span>
</span><span id=__span-4-8><a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=w>        </span>clientSignedCert:
</span><span id=__span-4-9><a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a><span class=w>          </span>path:<span class=w> </span><span class=s1>&#39;../fabric-samples/test-network/organizations/peerOrganizations/org1.example.com/users/User1@org1.example.com/msp/signcerts/User1@org1.example.com-cert.pem&#39;</span>
</span><span id=__span-4-10><a id=__codelineno-4-10 name=__codelineno-4-10 href=#__codelineno-4-10></a><span class=w>    </span>connectionProfile:
</span><span id=__span-4-11><a id=__codelineno-4-11 name=__codelineno-4-11 href=#__codelineno-4-11></a><span class=w>      </span>path:<span class=w> </span><span class=s1>&#39;../fabric-samples/test-network/organizations/peerOrganizations/org1.example.com/connection-org1.yaml&#39;</span>
</span><span id=__span-4-12><a id=__codelineno-4-12 name=__codelineno-4-12 href=#__codelineno-4-12></a><span class=c1># Uncomment the next line only if you want to try this network configuration file binding to fabric:2.2, it&#39;s not required for fabric-gateway binding</span>
</span><span id=__span-4-13><a id=__codelineno-4-13 name=__codelineno-4-13 href=#__codelineno-4-13></a><span class=c1>#      discover: true</span>
</span></code></pre></div> <p>Note the <code>-</code> sign in front of <code>mspid</code> and <code>name</code> in the above example. These are important as organizations could contain more than 1 organization. certificates can also contain a list defining more than 1 identity.</p> <p>One other important point to note; The first organization defined in the file is known as the default organization. In workload modules if you don’t specify an invoking organization, then the default organization is used. As there is only 1 organization defined anyway you will not see any reference to the invoking organization in the workload implementation.</p> <h4 id=channels>Channels<a class=headerlink href=#channels title="Permanent link">&para;</a></h4> <p>The Fabric connector for Caliper requires assistance when creating connections to a Fabric network. A list of <code>channels</code> must be provided that lists the smart contracts that may be interacted with.</p> <p>As part of the <code>test-network</code> tutorial, a channel of <code>mychannel</code> will have been created and a contract (chaincode) with the id of basic will have been instantiated on that channel. We declare this as follows</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-5-1><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a>channels:
</span><span id=__span-5-2><a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=w>  </span>-<span class=w> </span>channelName:<span class=w> </span>mychannel
</span><span id=__span-5-3><a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a><span class=w>    </span>contracts:
</span><span id=__span-5-4><a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=w>    </span>-<span class=w> </span>id:<span class=w> </span>basic
</span></code></pre></div> <p>note the <code>-</code> sign in front of <code>channelName</code> and <code>id</code> in the above example. This is required because there can be more than 1 channel so channels specify a list of channels and contracts can have more than 1 contract (chaincode) ids that are of interest.</p> <h3 id=the-complete-network-configuration-file>The Complete Network Configuration File<a class=headerlink href=#the-complete-network-configuration-file title="Permanent link">&para;</a></h3> <p>The Caliper network configuration file should now be fully populated. It can be useful to take time to look over and ensure that the paths to the certificates, private keys and connection profile are correct.</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-6-1><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a>name:<span class=w> </span>Calier<span class=w> </span><span class=nb>test</span>
</span><span id=__span-6-2><a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>version:<span class=w> </span><span class=s2>&quot;2.0.0&quot;</span>
</span><span id=__span-6-3><a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>
</span><span id=__span-6-4><a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>caliper:
</span><span id=__span-6-5><a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=w>  </span>blockchain:<span class=w> </span>fabric
</span><span id=__span-6-6><a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a>
</span><span id=__span-6-7><a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a>channels:
</span><span id=__span-6-8><a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a><span class=w>  </span>-<span class=w> </span>channelName:<span class=w> </span>mychannel
</span><span id=__span-6-9><a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a><span class=w>    </span>contracts:
</span><span id=__span-6-10><a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a><span class=w>    </span>-<span class=w> </span>id:<span class=w> </span>basic
</span><span id=__span-6-11><a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a>
</span><span id=__span-6-12><a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a>organizations:
</span><span id=__span-6-13><a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a><span class=w>  </span>-<span class=w> </span>mspid:<span class=w> </span>Org1MSP
</span><span id=__span-6-14><a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a><span class=w>    </span>identities:
</span><span id=__span-6-15><a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a><span class=w>      </span>certificates:
</span><span id=__span-6-16><a id=__codelineno-6-16 name=__codelineno-6-16 href=#__codelineno-6-16></a><span class=w>      </span>-<span class=w> </span>name:<span class=w> </span><span class=s1>&#39;User1&#39;</span>
</span><span id=__span-6-17><a id=__codelineno-6-17 name=__codelineno-6-17 href=#__codelineno-6-17></a><span class=w>        </span>clientPrivateKey:
</span><span id=__span-6-18><a id=__codelineno-6-18 name=__codelineno-6-18 href=#__codelineno-6-18></a><span class=w>          </span>path:<span class=w> </span><span class=s1>&#39;../fabric-samples/test-network/organizations/peerOrganizations/org1.example.com/users/User1@org1.example.com/msp/keystore/priv_sk&#39;</span>
</span><span id=__span-6-19><a id=__codelineno-6-19 name=__codelineno-6-19 href=#__codelineno-6-19></a><span class=w>        </span>clientSignedCert:
</span><span id=__span-6-20><a id=__codelineno-6-20 name=__codelineno-6-20 href=#__codelineno-6-20></a><span class=w>          </span>path:<span class=w> </span><span class=s1>&#39;../fabric-samples/test-network/organizations/peerOrganizations/org1.example.com/users/User1@org1.example.com/msp/signcerts/User1@org1.example.com-cert.pem&#39;</span>
</span><span id=__span-6-21><a id=__codelineno-6-21 name=__codelineno-6-21 href=#__codelineno-6-21></a><span class=w>    </span>connectionProfile:
</span><span id=__span-6-22><a id=__codelineno-6-22 name=__codelineno-6-22 href=#__codelineno-6-22></a><span class=w>      </span>path:<span class=w> </span><span class=s1>&#39;../fabric-samples/test-network/organizations/peerOrganizations/org1.example.com/connection-org1.yaml&#39;</span>
</span><span id=__span-6-23><a id=__codelineno-6-23 name=__codelineno-6-23 href=#__codelineno-6-23></a><span class=c1># Uncomment the next line only if you want to try this network configuration file binding to fabric:2.2, it&#39;s not required for fabric-gateway binding</span>
</span><span id=__span-6-24><a id=__codelineno-6-24 name=__codelineno-6-24 href=#__codelineno-6-24></a><span class=c1>#      discover: true</span>
</span></code></pre></div> <h2 id=step-3-build-a-test-workload-module>Step 3 - Build a Test Workload Module<a class=headerlink href=#step-3-build-a-test-workload-module title="Permanent link">&para;</a></h2> <p>The workload module interacts with the deployed smart contract during the benchmark round. The workload module extends the Caliper class <code>WorkloadModuleBase</code> from <code>caliper-core</code>. The workload module provides three overrides:</p> <ul> <li><code>initializeWorkloadModule</code> - used to initialize any required items for the benchmark</li> <li><code>submitTransaction</code> - used to interact with the smart contract method during the monitored phase of the benchmark</li> <li><code>cleanupWorkloadModule</code> - used to clean up after the completion of the benchmark</li> </ul> <p>For more information, please see the specific documentation on <code>Workload Configuration</code> accessible on the left hand menu.</p> <p>The workload we will be driving aims to benchmark the querying of existing assets within the world state database. Consequently we will use all three phases available in the workload module:</p> <ul> <li><code>initializeWorkloadModule</code> - to create assets that may be queried in the <code>submitTransaction</code> phase</li> <li><code>submitTransaction</code> - to query assets created in the <code>initializeWorkloadModule</code> phase</li> <li><code>cleanupWorkloadModule</code> - used to remove assets created in the <code>initializeWorkloadModule</code> phase so that the benchmark may be repeated</li> </ul> <h3 id=create-a-template-workload-module>Create A Template Workload Module<a class=headerlink href=#create-a-template-workload-module title="Permanent link">&para;</a></h3> <p>Within the <strong>workload</strong> folder create a file called <strong>readAsset.js</strong> with the following content:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-7-1><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=s1>&#39;use strict&#39;</span><span class=p>;</span>
</span><span id=__span-7-2><a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a>
</span><span id=__span-7-3><a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a>const<span class=w> </span><span class=o>{</span><span class=w> </span>WorkloadModuleBase<span class=w> </span><span class=o>}</span><span class=w> </span><span class=o>=</span><span class=w> </span>require<span class=o>(</span><span class=s1>&#39;@hyperledger/caliper-core&#39;</span><span class=o>)</span><span class=p>;</span>
</span><span id=__span-7-4><a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a>
</span><span id=__span-7-5><a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a>class<span class=w> </span>MyWorkload<span class=w> </span>extends<span class=w> </span>WorkloadModuleBase<span class=w> </span><span class=o>{</span>
</span><span id=__span-7-6><a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=w>    </span>constructor<span class=o>()</span><span class=w> </span><span class=o>{</span>
</span><span id=__span-7-7><a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a><span class=w>        </span>super<span class=o>()</span><span class=p>;</span>
</span><span id=__span-7-8><a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a><span class=w>    </span><span class=o>}</span>
</span><span id=__span-7-9><a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a>
</span><span id=__span-7-10><a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a><span class=w>    </span>async<span class=w> </span>initializeWorkloadModule<span class=o>(</span>workerIndex,<span class=w> </span>totalWorkers,<span class=w> </span>roundIndex,<span class=w> </span>roundArguments,<span class=w> </span>sutAdapter,<span class=w> </span>sutContext<span class=o>)</span><span class=w> </span><span class=o>{</span>
</span><span id=__span-7-11><a id=__codelineno-7-11 name=__codelineno-7-11 href=#__codelineno-7-11></a><span class=w>        </span>await<span class=w> </span>super.initializeWorkloadModule<span class=o>(</span>workerIndex,<span class=w> </span>totalWorkers,<span class=w> </span>roundIndex,<span class=w> </span>roundArguments,<span class=w> </span>sutAdapter,<span class=w> </span>sutContext<span class=o>)</span><span class=p>;</span>
</span><span id=__span-7-12><a id=__codelineno-7-12 name=__codelineno-7-12 href=#__codelineno-7-12></a><span class=w>    </span><span class=o>}</span>
</span><span id=__span-7-13><a id=__codelineno-7-13 name=__codelineno-7-13 href=#__codelineno-7-13></a>
</span><span id=__span-7-14><a id=__codelineno-7-14 name=__codelineno-7-14 href=#__codelineno-7-14></a><span class=w>    </span>async<span class=w> </span>submitTransaction<span class=o>()</span><span class=w> </span><span class=o>{</span>
</span><span id=__span-7-15><a id=__codelineno-7-15 name=__codelineno-7-15 href=#__codelineno-7-15></a><span class=w>        </span>//<span class=w> </span>NOOP
</span><span id=__span-7-16><a id=__codelineno-7-16 name=__codelineno-7-16 href=#__codelineno-7-16></a><span class=w>    </span><span class=o>}</span>
</span><span id=__span-7-17><a id=__codelineno-7-17 name=__codelineno-7-17 href=#__codelineno-7-17></a>
</span><span id=__span-7-18><a id=__codelineno-7-18 name=__codelineno-7-18 href=#__codelineno-7-18></a><span class=w>    </span>async<span class=w> </span>cleanupWorkloadModule<span class=o>()</span><span class=w> </span><span class=o>{</span>
</span><span id=__span-7-19><a id=__codelineno-7-19 name=__codelineno-7-19 href=#__codelineno-7-19></a><span class=w>        </span>//<span class=w> </span>NOOP
</span><span id=__span-7-20><a id=__codelineno-7-20 name=__codelineno-7-20 href=#__codelineno-7-20></a><span class=w>    </span><span class=o>}</span>
</span><span id=__span-7-21><a id=__codelineno-7-21 name=__codelineno-7-21 href=#__codelineno-7-21></a><span class=o>}</span>
</span><span id=__span-7-22><a id=__codelineno-7-22 name=__codelineno-7-22 href=#__codelineno-7-22></a>
</span><span id=__span-7-23><a id=__codelineno-7-23 name=__codelineno-7-23 href=#__codelineno-7-23></a><span class=k>function</span><span class=w> </span>createWorkloadModule<span class=o>()</span><span class=w> </span><span class=o>{</span>
</span><span id=__span-7-24><a id=__codelineno-7-24 name=__codelineno-7-24 href=#__codelineno-7-24></a><span class=w>    </span><span class=k>return</span><span class=w> </span>new<span class=w> </span>MyWorkload<span class=o>()</span><span class=p>;</span>
</span><span id=__span-7-25><a id=__codelineno-7-25 name=__codelineno-7-25 href=#__codelineno-7-25></a><span class=o>}</span>
</span><span id=__span-7-26><a id=__codelineno-7-26 name=__codelineno-7-26 href=#__codelineno-7-26></a>
</span><span id=__span-7-27><a id=__codelineno-7-27 name=__codelineno-7-27 href=#__codelineno-7-27></a>module.exports.createWorkloadModule<span class=w> </span><span class=o>=</span><span class=w> </span>createWorkloadModule<span class=p>;</span>
</span></code></pre></div> <h3 id=populating-the-template-file_1>Populating the Template File<a class=headerlink href=#populating-the-template-file_1 title="Permanent link">&para;</a></h3> <p>When we populate this file we make reference to the available methods within the deployed smart contract <strong>assetTransfer.js</strong> file that can be found in: <strong>fabric-samples -&gt; asset-transfer-basic -&gt; chaincode-javascript -&gt; lib -&gt; assetTransfer.js</strong></p> <h4 id=populate-initializeworkloadmodule>Populate initializeWorkloadModule<a class=headerlink href=#populate-initializeworkloadmodule title="Permanent link">&para;</a></h4> <p>This method is used to prepare any items required by the primary <code>submitTransaction</code> method as the benchmark completes.</p> <p>The number of assets to be created will be given as <code>roundArguments.assets</code>. We create assets using the smart contract by populating an arguments object, which defines the transaction body, and using the Caliper API <code>sendRequests</code>, which requires knowledge of:</p> <ul> <li>contractId, the name of smart contract that is to be used and is present within the Caliper network configuration file</li> <li>contractFunction, the specific function within the smart contract to invoke</li> <li>contractArguments, the arguments to pass to the smart contract function</li> <li>invokerIdentity, the identity to use that is present within the Caliper network configuration file. This can be optional and caliper will select an identity for you (from the appropriate invoking organization or default organization) and in this tutorial there would only ever be 1 identity to pick but for completeness the examples explicitly define the identity.</li> <li>readOnly, if performing a query operation or not</li> </ul> <p>The method should look like this:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-8-1><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=w>    </span>async<span class=w> </span>initializeWorkloadModule<span class=o>(</span>workerIndex,<span class=w> </span>totalWorkers,<span class=w> </span>roundIndex,<span class=w> </span>roundArguments,<span class=w> </span>sutAdapter,<span class=w> </span>sutContext<span class=o>)</span><span class=w> </span><span class=o>{</span>
</span><span id=__span-8-2><a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=w>        </span>await<span class=w> </span>super.initializeWorkloadModule<span class=o>(</span>workerIndex,<span class=w> </span>totalWorkers,<span class=w> </span>roundIndex,<span class=w> </span>roundArguments,<span class=w> </span>sutAdapter,<span class=w> </span>sutContext<span class=o>)</span><span class=p>;</span>
</span><span id=__span-8-3><a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a>
</span><span id=__span-8-4><a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=o>(</span><span class=nb>let</span><span class=w> </span><span class=nv>i</span><span class=o>=</span><span class=m>0</span><span class=p>;</span><span class=w> </span>i&lt;this.roundArguments.assets<span class=p>;</span><span class=w> </span>i++<span class=o>)</span><span class=w> </span><span class=o>{</span>
</span><span id=__span-8-5><a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=w>            </span>const<span class=w> </span><span class=nv>assetID</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=sb>`</span><span class=si>${</span><span class=nv>this</span><span class=p>.workerIndex</span><span class=si>}</span>_<span class=si>${</span><span class=nv>i</span><span class=si>}</span><span class=sb>`</span><span class=p>;</span>
</span><span id=__span-8-6><a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a><span class=w>            </span>console.log<span class=o>(</span><span class=sb>`</span>Worker<span class=w> </span><span class=si>${</span><span class=nv>this</span><span class=p>.workerIndex</span><span class=si>}</span>:<span class=w> </span>Creating<span class=w> </span>asset<span class=w> </span><span class=si>${</span><span class=nv>assetID</span><span class=si>}</span><span class=sb>`</span><span class=o>)</span><span class=p>;</span>
</span><span id=__span-8-7><a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a><span class=w>            </span>const<span class=w> </span><span class=nv>request</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>{</span>
</span><span id=__span-8-8><a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a><span class=w>                </span>contractId:<span class=w> </span>this.roundArguments.contractId,
</span><span id=__span-8-9><a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a><span class=w>                </span>contractFunction:<span class=w> </span><span class=s1>&#39;CreateAsset&#39;</span>,
</span><span id=__span-8-10><a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a><span class=w>                </span>invokerIdentity:<span class=w> </span><span class=s1>&#39;User1&#39;</span>,
</span><span id=__span-8-11><a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a><span class=w>                </span>contractArguments:<span class=w> </span><span class=o>[</span>assetID,<span class=s1>&#39;blue&#39;</span>,<span class=s1>&#39;20&#39;</span>,<span class=s1>&#39;penguin&#39;</span>,<span class=s1>&#39;500&#39;</span><span class=o>]</span>,
</span><span id=__span-8-12><a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a><span class=w>                </span>readOnly:<span class=w> </span><span class=nb>false</span>
</span><span id=__span-8-13><a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a><span class=w>            </span><span class=o>}</span><span class=p>;</span>
</span><span id=__span-8-14><a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a>
</span><span id=__span-8-15><a id=__codelineno-8-15 name=__codelineno-8-15 href=#__codelineno-8-15></a><span class=w>            </span>await<span class=w> </span>this.sutAdapter.sendRequests<span class=o>(</span>request<span class=o>)</span><span class=p>;</span>
</span><span id=__span-8-16><a id=__codelineno-8-16 name=__codelineno-8-16 href=#__codelineno-8-16></a><span class=w>        </span><span class=o>}</span>
</span><span id=__span-8-17><a id=__codelineno-8-17 name=__codelineno-8-17 href=#__codelineno-8-17></a><span class=w>    </span><span class=o>}</span>
</span></code></pre></div> <p>In the above example, different assets will be created that have the same parameters (blue, 20, penguin, 500). Comparing the above to the smart contract method itself, it should be evident that there is a 1:1 mapping of contract arguments to the method parameters.</p> <h4 id=populate-submittransaction>Populate submitTransaction<a class=headerlink href=#populate-submittransaction title="Permanent link">&para;</a></h4> <p>This method runs repeatedly in the benchmark test phase. We will be evaluating the <code>ReadAsset</code> smart contract method by querying the assets we created in the <code>initializeWorkloadModule</code> method.</p> <p>First, create a string identity for the asset to query, formed by the concatenation of the worker index and a random integer between 0 and the number of created assets.</p> <p>Then await the call on <code>sendRequests</code>, passing an object containing: <code>contractId</code> set as that passed in from the round arguments; <code>contractFunction</code> set as <code>ReadAsset</code>; <code>invokerIdentity</code> set as <code>User1</code>; and <code>chaincodeArguments</code> set as an array that contains the asset to query in this run.</p> <p>The method should look like this:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-9-1><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=w>    </span>async<span class=w> </span>submitTransaction<span class=o>()</span><span class=w> </span><span class=o>{</span>
</span><span id=__span-9-2><a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a><span class=w>        </span>const<span class=w> </span><span class=nv>randomId</span><span class=w> </span><span class=o>=</span><span class=w> </span>Math.floor<span class=o>(</span>Math.random<span class=o>()</span>*this.roundArguments.assets<span class=o>)</span><span class=p>;</span>
</span><span id=__span-9-3><a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=w>        </span>const<span class=w> </span><span class=nv>myArgs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>{</span>
</span><span id=__span-9-4><a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a><span class=w>            </span>contractId:<span class=w> </span>this.roundArguments.contractId,
</span><span id=__span-9-5><a id=__codelineno-9-5 name=__codelineno-9-5 href=#__codelineno-9-5></a><span class=w>            </span>contractFunction:<span class=w> </span><span class=s1>&#39;ReadAsset&#39;</span>,
</span><span id=__span-9-6><a id=__codelineno-9-6 name=__codelineno-9-6 href=#__codelineno-9-6></a><span class=w>            </span>invokerIdentity:<span class=w> </span><span class=s1>&#39;User1&#39;</span>,
</span><span id=__span-9-7><a id=__codelineno-9-7 name=__codelineno-9-7 href=#__codelineno-9-7></a><span class=w>            </span>contractArguments:<span class=w> </span><span class=o>[</span><span class=sb>`</span><span class=si>${</span><span class=nv>this</span><span class=p>.workerIndex</span><span class=si>}</span>_<span class=si>${</span><span class=nv>randomId</span><span class=si>}</span><span class=sb>`</span><span class=o>]</span>,
</span><span id=__span-9-8><a id=__codelineno-9-8 name=__codelineno-9-8 href=#__codelineno-9-8></a><span class=w>            </span>readOnly:<span class=w> </span><span class=nb>true</span>
</span><span id=__span-9-9><a id=__codelineno-9-9 name=__codelineno-9-9 href=#__codelineno-9-9></a><span class=w>        </span><span class=o>}</span><span class=p>;</span>
</span><span id=__span-9-10><a id=__codelineno-9-10 name=__codelineno-9-10 href=#__codelineno-9-10></a>
</span><span id=__span-9-11><a id=__codelineno-9-11 name=__codelineno-9-11 href=#__codelineno-9-11></a><span class=w>        </span>await<span class=w> </span>this.sutAdapter.sendRequests<span class=o>(</span>myArgs<span class=o>)</span><span class=p>;</span>
</span><span id=__span-9-12><a id=__codelineno-9-12 name=__codelineno-9-12 href=#__codelineno-9-12></a><span class=w>    </span><span class=o>}</span>
</span></code></pre></div> <h4 id=populate-cleanupworkloadmodule>Populate cleanupWorkloadModule<a class=headerlink href=#populate-cleanupworkloadmodule title="Permanent link">&para;</a></h4> <p>This function is used to clean up after a test as it deletes the assets created in the <code>initializeWorkloadModule</code> function though use of the smart contract function <code>DeleteAsset</code>. The implementation is similar to that within <code>initializeWorkloadModule</code>. Note it is possible to refactor both <code>initializeWorkloadModule</code> and <code>cleanupWorkloadModule</code> to utilize a common method that performs the create/delete action, this is left to the interested reader.</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-10-1><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=w>   </span>async<span class=w> </span>cleanupWorkloadModule<span class=o>()</span><span class=w> </span><span class=o>{</span>
</span><span id=__span-10-2><a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=o>(</span><span class=nb>let</span><span class=w> </span><span class=nv>i</span><span class=o>=</span><span class=m>0</span><span class=p>;</span><span class=w> </span>i&lt;this.roundArguments.assets<span class=p>;</span><span class=w> </span>i++<span class=o>)</span><span class=w> </span><span class=o>{</span>
</span><span id=__span-10-3><a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=w>            </span>const<span class=w> </span><span class=nv>assetID</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=sb>`</span><span class=si>${</span><span class=nv>this</span><span class=p>.workerIndex</span><span class=si>}</span>_<span class=si>${</span><span class=nv>i</span><span class=si>}</span><span class=sb>`</span><span class=p>;</span>
</span><span id=__span-10-4><a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=w>            </span>console.log<span class=o>(</span><span class=sb>`</span>Worker<span class=w> </span><span class=si>${</span><span class=nv>this</span><span class=p>.workerIndex</span><span class=si>}</span>:<span class=w> </span>Deleting<span class=w> </span>asset<span class=w> </span><span class=si>${</span><span class=nv>assetID</span><span class=si>}</span><span class=sb>`</span><span class=o>)</span><span class=p>;</span>
</span><span id=__span-10-5><a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=w>            </span>const<span class=w> </span><span class=nv>request</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>{</span>
</span><span id=__span-10-6><a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a><span class=w>                </span>contractId:<span class=w> </span>this.roundArguments.contractId,
</span><span id=__span-10-7><a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a><span class=w>                </span>contractFunction:<span class=w> </span><span class=s1>&#39;DeleteAsset&#39;</span>,
</span><span id=__span-10-8><a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a><span class=w>                </span>invokerIdentity:<span class=w> </span><span class=s1>&#39;User1&#39;</span>,
</span><span id=__span-10-9><a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a><span class=w>                </span>contractArguments:<span class=w> </span><span class=o>[</span>assetID<span class=o>]</span>,
</span><span id=__span-10-10><a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a><span class=w>                </span>readOnly:<span class=w> </span><span class=nb>false</span>
</span><span id=__span-10-11><a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a><span class=w>            </span><span class=o>}</span><span class=p>;</span>
</span><span id=__span-10-12><a id=__codelineno-10-12 name=__codelineno-10-12 href=#__codelineno-10-12></a>
</span><span id=__span-10-13><a id=__codelineno-10-13 name=__codelineno-10-13 href=#__codelineno-10-13></a><span class=w>            </span>await<span class=w> </span>this.sutAdapter.sendRequests<span class=o>(</span>request<span class=o>)</span><span class=p>;</span>
</span><span id=__span-10-14><a id=__codelineno-10-14 name=__codelineno-10-14 href=#__codelineno-10-14></a><span class=w>        </span><span class=o>}</span>
</span><span id=__span-10-15><a id=__codelineno-10-15 name=__codelineno-10-15 href=#__codelineno-10-15></a><span class=w>    </span><span class=o>}</span>
</span></code></pre></div> <h3 id=the-complete-workload-module>The Complete Workload Module<a class=headerlink href=#the-complete-workload-module title="Permanent link">&para;</a></h3> <p>The test callback file should now be fully populated:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-11-1><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=s1>&#39;use strict&#39;</span><span class=p>;</span>
</span><span id=__span-11-2><a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>
</span><span id=__span-11-3><a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a>const<span class=w> </span><span class=o>{</span><span class=w> </span>WorkloadModuleBase<span class=w> </span><span class=o>}</span><span class=w> </span><span class=o>=</span><span class=w> </span>require<span class=o>(</span><span class=s1>&#39;@hyperledger/caliper-core&#39;</span><span class=o>)</span><span class=p>;</span>
</span><span id=__span-11-4><a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a>
</span><span id=__span-11-5><a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a>class<span class=w> </span>MyWorkload<span class=w> </span>extends<span class=w> </span>WorkloadModuleBase<span class=w> </span><span class=o>{</span>
</span><span id=__span-11-6><a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a><span class=w>    </span>constructor<span class=o>()</span><span class=w> </span><span class=o>{</span>
</span><span id=__span-11-7><a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a><span class=w>        </span>super<span class=o>()</span><span class=p>;</span>
</span><span id=__span-11-8><a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a><span class=w>    </span><span class=o>}</span>
</span><span id=__span-11-9><a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a>
</span><span id=__span-11-10><a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a><span class=w>    </span>async<span class=w> </span>initializeWorkloadModule<span class=o>(</span>workerIndex,<span class=w> </span>totalWorkers,<span class=w> </span>roundIndex,<span class=w> </span>roundArguments,<span class=w> </span>sutAdapter,<span class=w> </span>sutContext<span class=o>)</span><span class=w> </span><span class=o>{</span>
</span><span id=__span-11-11><a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a><span class=w>        </span>await<span class=w> </span>super.initializeWorkloadModule<span class=o>(</span>workerIndex,<span class=w> </span>totalWorkers,<span class=w> </span>roundIndex,<span class=w> </span>roundArguments,<span class=w> </span>sutAdapter,<span class=w> </span>sutContext<span class=o>)</span><span class=p>;</span>
</span><span id=__span-11-12><a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a>
</span><span id=__span-11-13><a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=o>(</span><span class=nb>let</span><span class=w> </span><span class=nv>i</span><span class=o>=</span><span class=m>0</span><span class=p>;</span><span class=w> </span>i&lt;this.roundArguments.assets<span class=p>;</span><span class=w> </span>i++<span class=o>)</span><span class=w> </span><span class=o>{</span>
</span><span id=__span-11-14><a id=__codelineno-11-14 name=__codelineno-11-14 href=#__codelineno-11-14></a><span class=w>            </span>const<span class=w> </span><span class=nv>assetID</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=sb>`</span><span class=si>${</span><span class=nv>this</span><span class=p>.workerIndex</span><span class=si>}</span>_<span class=si>${</span><span class=nv>i</span><span class=si>}</span><span class=sb>`</span><span class=p>;</span>
</span><span id=__span-11-15><a id=__codelineno-11-15 name=__codelineno-11-15 href=#__codelineno-11-15></a><span class=w>            </span>console.log<span class=o>(</span><span class=sb>`</span>Worker<span class=w> </span><span class=si>${</span><span class=nv>this</span><span class=p>.workerIndex</span><span class=si>}</span>:<span class=w> </span>Creating<span class=w> </span>asset<span class=w> </span><span class=si>${</span><span class=nv>assetID</span><span class=si>}</span><span class=sb>`</span><span class=o>)</span><span class=p>;</span>
</span><span id=__span-11-16><a id=__codelineno-11-16 name=__codelineno-11-16 href=#__codelineno-11-16></a><span class=w>            </span>const<span class=w> </span><span class=nv>request</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>{</span>
</span><span id=__span-11-17><a id=__codelineno-11-17 name=__codelineno-11-17 href=#__codelineno-11-17></a><span class=w>                </span>contractId:<span class=w> </span>this.roundArguments.contractId,
</span><span id=__span-11-18><a id=__codelineno-11-18 name=__codelineno-11-18 href=#__codelineno-11-18></a><span class=w>                </span>contractFunction:<span class=w> </span><span class=s1>&#39;CreateAsset&#39;</span>,
</span><span id=__span-11-19><a id=__codelineno-11-19 name=__codelineno-11-19 href=#__codelineno-11-19></a><span class=w>                </span>invokerIdentity:<span class=w> </span><span class=s1>&#39;User1&#39;</span>,
</span><span id=__span-11-20><a id=__codelineno-11-20 name=__codelineno-11-20 href=#__codelineno-11-20></a><span class=w>                </span>contractArguments:<span class=w> </span><span class=o>[</span>assetID,<span class=s1>&#39;blue&#39;</span>,<span class=s1>&#39;20&#39;</span>,<span class=s1>&#39;penguin&#39;</span>,<span class=s1>&#39;500&#39;</span><span class=o>]</span>,
</span><span id=__span-11-21><a id=__codelineno-11-21 name=__codelineno-11-21 href=#__codelineno-11-21></a><span class=w>                </span>readOnly:<span class=w> </span><span class=nb>false</span>
</span><span id=__span-11-22><a id=__codelineno-11-22 name=__codelineno-11-22 href=#__codelineno-11-22></a><span class=w>            </span><span class=o>}</span><span class=p>;</span>
</span><span id=__span-11-23><a id=__codelineno-11-23 name=__codelineno-11-23 href=#__codelineno-11-23></a>
</span><span id=__span-11-24><a id=__codelineno-11-24 name=__codelineno-11-24 href=#__codelineno-11-24></a><span class=w>            </span>await<span class=w> </span>this.sutAdapter.sendRequests<span class=o>(</span>request<span class=o>)</span><span class=p>;</span>
</span><span id=__span-11-25><a id=__codelineno-11-25 name=__codelineno-11-25 href=#__codelineno-11-25></a><span class=w>        </span><span class=o>}</span>
</span><span id=__span-11-26><a id=__codelineno-11-26 name=__codelineno-11-26 href=#__codelineno-11-26></a><span class=w>    </span><span class=o>}</span>
</span><span id=__span-11-27><a id=__codelineno-11-27 name=__codelineno-11-27 href=#__codelineno-11-27></a>
</span><span id=__span-11-28><a id=__codelineno-11-28 name=__codelineno-11-28 href=#__codelineno-11-28></a><span class=w>    </span>async<span class=w> </span>submitTransaction<span class=o>()</span><span class=w> </span><span class=o>{</span>
</span><span id=__span-11-29><a id=__codelineno-11-29 name=__codelineno-11-29 href=#__codelineno-11-29></a><span class=w>        </span>const<span class=w> </span><span class=nv>randomId</span><span class=w> </span><span class=o>=</span><span class=w> </span>Math.floor<span class=o>(</span>Math.random<span class=o>()</span>*this.roundArguments.assets<span class=o>)</span><span class=p>;</span>
</span><span id=__span-11-30><a id=__codelineno-11-30 name=__codelineno-11-30 href=#__codelineno-11-30></a><span class=w>        </span>const<span class=w> </span><span class=nv>myArgs</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>{</span>
</span><span id=__span-11-31><a id=__codelineno-11-31 name=__codelineno-11-31 href=#__codelineno-11-31></a><span class=w>            </span>contractId:<span class=w> </span>this.roundArguments.contractId,
</span><span id=__span-11-32><a id=__codelineno-11-32 name=__codelineno-11-32 href=#__codelineno-11-32></a><span class=w>            </span>contractFunction:<span class=w> </span><span class=s1>&#39;ReadAsset&#39;</span>,
</span><span id=__span-11-33><a id=__codelineno-11-33 name=__codelineno-11-33 href=#__codelineno-11-33></a><span class=w>            </span>invokerIdentity:<span class=w> </span><span class=s1>&#39;User1&#39;</span>,
</span><span id=__span-11-34><a id=__codelineno-11-34 name=__codelineno-11-34 href=#__codelineno-11-34></a><span class=w>            </span>contractArguments:<span class=w> </span><span class=o>[</span><span class=sb>`</span><span class=si>${</span><span class=nv>this</span><span class=p>.workerIndex</span><span class=si>}</span>_<span class=si>${</span><span class=nv>randomId</span><span class=si>}</span><span class=sb>`</span><span class=o>]</span>,
</span><span id=__span-11-35><a id=__codelineno-11-35 name=__codelineno-11-35 href=#__codelineno-11-35></a><span class=w>            </span>readOnly:<span class=w> </span><span class=nb>true</span>
</span><span id=__span-11-36><a id=__codelineno-11-36 name=__codelineno-11-36 href=#__codelineno-11-36></a><span class=w>        </span><span class=o>}</span><span class=p>;</span>
</span><span id=__span-11-37><a id=__codelineno-11-37 name=__codelineno-11-37 href=#__codelineno-11-37></a>
</span><span id=__span-11-38><a id=__codelineno-11-38 name=__codelineno-11-38 href=#__codelineno-11-38></a><span class=w>        </span>await<span class=w> </span>this.sutAdapter.sendRequests<span class=o>(</span>myArgs<span class=o>)</span><span class=p>;</span>
</span><span id=__span-11-39><a id=__codelineno-11-39 name=__codelineno-11-39 href=#__codelineno-11-39></a><span class=w>    </span><span class=o>}</span>
</span><span id=__span-11-40><a id=__codelineno-11-40 name=__codelineno-11-40 href=#__codelineno-11-40></a>
</span><span id=__span-11-41><a id=__codelineno-11-41 name=__codelineno-11-41 href=#__codelineno-11-41></a><span class=w>    </span>async<span class=w> </span>cleanupWorkloadModule<span class=o>()</span><span class=w> </span><span class=o>{</span>
</span><span id=__span-11-42><a id=__codelineno-11-42 name=__codelineno-11-42 href=#__codelineno-11-42></a><span class=w>        </span><span class=k>for</span><span class=w> </span><span class=o>(</span><span class=nb>let</span><span class=w> </span><span class=nv>i</span><span class=o>=</span><span class=m>0</span><span class=p>;</span><span class=w> </span>i&lt;this.roundArguments.assets<span class=p>;</span><span class=w> </span>i++<span class=o>)</span><span class=w> </span><span class=o>{</span>
</span><span id=__span-11-43><a id=__codelineno-11-43 name=__codelineno-11-43 href=#__codelineno-11-43></a><span class=w>            </span>const<span class=w> </span><span class=nv>assetID</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=sb>`</span><span class=si>${</span><span class=nv>this</span><span class=p>.workerIndex</span><span class=si>}</span>_<span class=si>${</span><span class=nv>i</span><span class=si>}</span><span class=sb>`</span><span class=p>;</span>
</span><span id=__span-11-44><a id=__codelineno-11-44 name=__codelineno-11-44 href=#__codelineno-11-44></a><span class=w>            </span>console.log<span class=o>(</span><span class=sb>`</span>Worker<span class=w> </span><span class=si>${</span><span class=nv>this</span><span class=p>.workerIndex</span><span class=si>}</span>:<span class=w> </span>Deleting<span class=w> </span>asset<span class=w> </span><span class=si>${</span><span class=nv>assetID</span><span class=si>}</span><span class=sb>`</span><span class=o>)</span><span class=p>;</span>
</span><span id=__span-11-45><a id=__codelineno-11-45 name=__codelineno-11-45 href=#__codelineno-11-45></a><span class=w>            </span>const<span class=w> </span><span class=nv>request</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>{</span>
</span><span id=__span-11-46><a id=__codelineno-11-46 name=__codelineno-11-46 href=#__codelineno-11-46></a><span class=w>                </span>contractId:<span class=w> </span>this.roundArguments.contractId,
</span><span id=__span-11-47><a id=__codelineno-11-47 name=__codelineno-11-47 href=#__codelineno-11-47></a><span class=w>                </span>contractFunction:<span class=w> </span><span class=s1>&#39;DeleteAsset&#39;</span>,
</span><span id=__span-11-48><a id=__codelineno-11-48 name=__codelineno-11-48 href=#__codelineno-11-48></a><span class=w>                </span>invokerIdentity:<span class=w> </span><span class=s1>&#39;User1&#39;</span>,
</span><span id=__span-11-49><a id=__codelineno-11-49 name=__codelineno-11-49 href=#__codelineno-11-49></a><span class=w>                </span>contractArguments:<span class=w> </span><span class=o>[</span>assetID<span class=o>]</span>,
</span><span id=__span-11-50><a id=__codelineno-11-50 name=__codelineno-11-50 href=#__codelineno-11-50></a><span class=w>                </span>readOnly:<span class=w> </span><span class=nb>false</span>
</span><span id=__span-11-51><a id=__codelineno-11-51 name=__codelineno-11-51 href=#__codelineno-11-51></a><span class=w>            </span><span class=o>}</span><span class=p>;</span>
</span><span id=__span-11-52><a id=__codelineno-11-52 name=__codelineno-11-52 href=#__codelineno-11-52></a>
</span><span id=__span-11-53><a id=__codelineno-11-53 name=__codelineno-11-53 href=#__codelineno-11-53></a><span class=w>            </span>await<span class=w> </span>this.sutAdapter.sendRequests<span class=o>(</span>request<span class=o>)</span><span class=p>;</span>
</span><span id=__span-11-54><a id=__codelineno-11-54 name=__codelineno-11-54 href=#__codelineno-11-54></a><span class=w>        </span><span class=o>}</span>
</span><span id=__span-11-55><a id=__codelineno-11-55 name=__codelineno-11-55 href=#__codelineno-11-55></a><span class=w>    </span><span class=o>}</span>
</span><span id=__span-11-56><a id=__codelineno-11-56 name=__codelineno-11-56 href=#__codelineno-11-56></a><span class=o>}</span>
</span><span id=__span-11-57><a id=__codelineno-11-57 name=__codelineno-11-57 href=#__codelineno-11-57></a>
</span><span id=__span-11-58><a id=__codelineno-11-58 name=__codelineno-11-58 href=#__codelineno-11-58></a><span class=k>function</span><span class=w> </span>createWorkloadModule<span class=o>()</span><span class=w> </span><span class=o>{</span>
</span><span id=__span-11-59><a id=__codelineno-11-59 name=__codelineno-11-59 href=#__codelineno-11-59></a><span class=w>    </span><span class=k>return</span><span class=w> </span>new<span class=w> </span>MyWorkload<span class=o>()</span><span class=p>;</span>
</span><span id=__span-11-60><a id=__codelineno-11-60 name=__codelineno-11-60 href=#__codelineno-11-60></a><span class=o>}</span>
</span><span id=__span-11-61><a id=__codelineno-11-61 name=__codelineno-11-61 href=#__codelineno-11-61></a>
</span><span id=__span-11-62><a id=__codelineno-11-62 name=__codelineno-11-62 href=#__codelineno-11-62></a>module.exports.createWorkloadModule<span class=w> </span><span class=o>=</span><span class=w> </span>createWorkloadModule<span class=p>;</span>
</span></code></pre></div> <h2 id=step-4-build-a-benchmark-configuration-file>Step 4 - Build a Benchmark Configuration File<a class=headerlink href=#step-4-build-a-benchmark-configuration-file title="Permanent link">&para;</a></h2> <p>The benchmark configuration file defines the benchmark rounds and references the defined workload module(s). It will specify the number of test workers to use when generating the load, the number of test rounds, the duration of each round, the rate control applied to the transaction load during each round, and options relating to monitors. This particular tutorial will not make use of any of the available resource and transaction monitors; for these details please refer to the documentation.</p> <p>The benchmark configuration file may be provided in a yaml or json format: here we will use a yaml format. Please note that yaml files are case sensitive and all labels are in lowercase.</p> <p>The benchmark configuration file has a single required stanza:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-12-1><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a>test:
</span></code></pre></div> <h3 id=create-a-template-benchmark-configuration-file>Create A Template Benchmark Configuration File<a class=headerlink href=#create-a-template-benchmark-configuration-file title="Permanent link">&para;</a></h3> <p>Under the benchmarks folder create a file called myAssetBenchmark.yaml with the following content:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-13-1><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a>test:
</span><span id=__span-13-2><a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a><span class=w>    </span>name:<span class=w> </span>basic-contract-benchmark
</span><span id=__span-13-3><a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a><span class=w>    </span>description:<span class=w> </span>A<span class=w> </span><span class=nb>test</span><span class=w> </span>benchmark
</span><span id=__span-13-4><a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=w>    </span>workers:
</span><span id=__span-13-5><a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a><span class=w>    </span>rounds:
</span></code></pre></div> <p><strong>test</strong>: The root level block that contains the benchmark test information.</p> <p><strong>name</strong>: The name of the test, in this case “basic-contract-benchmark”.</p> <p><strong>description</strong>: A description for the benchmark, in this case “A test benchmark”.</p> <p><strong>workers</strong>: A set of keys used to define the number of workers (separate worker client instances) used in the subsequent benchmark.</p> <p><strong>rounds</strong>: An array of distinct test rounds that will be progressed sequentially. Rounds may be used to benchmark different smart contract methods, or the same method in a different manner.</p> <h3 id=populating-the-template-file_2>Populating the Template File<a class=headerlink href=#populating-the-template-file_2 title="Permanent link">&para;</a></h3> <p>We will now populate the template file to specify the number of workers and the test round that uses the workload module we have created.</p> <h4 id=populate-workers>Populate Workers<a class=headerlink href=#populate-workers title="Permanent link">&para;</a></h4> <p>We will be using two separate workers, this is accomplished through the workers specification:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-14-1><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=w>  </span>number:<span class=w> </span><span class=m>2</span>
</span></code></pre></div> <h4 id=populate-rounds>Populate Rounds<a class=headerlink href=#populate-rounds title="Permanent link">&para;</a></h4> <p>Each <code>round</code> block contains the following:</p> <ul> <li><code>label</code> - the unique header label to use for the round.</li> <li><code>description</code> - a description of the round being run.</li> <li><code>txDuration</code> - the specification of the test duration, in seconds</li> <li><code>rateControl</code> - a rate control type, with options.</li> <li><code>workload</code>s - the workload module to use, with arguments to pass to the module. All arguments passed are available as roundArguments within the workload module.</li> </ul> <p>We will specify a benchmark round labeled <code>readAsset</code>, with the description <code>Query asset benchmark</code>, to run for a 30s duration, using a <code>fixed-load</code> rate controller aiming to maintain a constant transaction pressure of 2. Additionally we will be providing a workload through specification of our <code>readAsset.js</code> workload file, which we will pass the arguments <code>{assets: 10, contractId: asset-transfer-basic}</code>.</p> <p>The above is accomplished through the round specification:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-15-1><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=w>    </span>-<span class=w> </span>label:<span class=w> </span>readAsset
</span><span id=__span-15-2><a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a><span class=w>      </span>description:<span class=w> </span>Read<span class=w> </span>asset<span class=w> </span>benchmark
</span><span id=__span-15-3><a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a><span class=w>      </span>txDuration:<span class=w> </span><span class=m>30</span>
</span><span id=__span-15-4><a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a><span class=w>      </span>rateControl:
</span><span id=__span-15-5><a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a><span class=w>        </span>type:<span class=w> </span>fixed-load
</span><span id=__span-15-6><a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a><span class=w>        </span>opts:
</span><span id=__span-15-7><a id=__codelineno-15-7 name=__codelineno-15-7 href=#__codelineno-15-7></a><span class=w>          </span>transactionLoad:<span class=w> </span><span class=m>2</span>
</span><span id=__span-15-8><a id=__codelineno-15-8 name=__codelineno-15-8 href=#__codelineno-15-8></a><span class=w>      </span>workload:
</span><span id=__span-15-9><a id=__codelineno-15-9 name=__codelineno-15-9 href=#__codelineno-15-9></a><span class=w>        </span>module:<span class=w> </span>workload/readAsset.js
</span><span id=__span-15-10><a id=__codelineno-15-10 name=__codelineno-15-10 href=#__codelineno-15-10></a><span class=w>        </span>arguments:
</span><span id=__span-15-11><a id=__codelineno-15-11 name=__codelineno-15-11 href=#__codelineno-15-11></a><span class=w>          </span>assets:<span class=w> </span><span class=m>10</span>
</span><span id=__span-15-12><a id=__codelineno-15-12 name=__codelineno-15-12 href=#__codelineno-15-12></a><span class=w>          </span>contractId:<span class=w> </span>basic
</span></code></pre></div> <h3 id=the-complete-benchmark-configuration-file>The Complete Benchmark Configuration File<a class=headerlink href=#the-complete-benchmark-configuration-file title="Permanent link">&para;</a></h3> <p>The benchmark configuration file should now be fully populated:</p> <div class="language-sh highlight"><pre><span></span><code><span id=__span-16-1><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a>test:
</span><span id=__span-16-2><a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a><span class=w>    </span>name:<span class=w> </span>basic-contract-benchmark
</span><span id=__span-16-3><a id=__codelineno-16-3 name=__codelineno-16-3 href=#__codelineno-16-3></a><span class=w>    </span>description:<span class=w> </span><span class=nb>test</span><span class=w> </span>benchmark
</span><span id=__span-16-4><a id=__codelineno-16-4 name=__codelineno-16-4 href=#__codelineno-16-4></a><span class=w>    </span>workers:
</span><span id=__span-16-5><a id=__codelineno-16-5 name=__codelineno-16-5 href=#__codelineno-16-5></a><span class=w>      </span>number:<span class=w> </span><span class=m>2</span>
</span><span id=__span-16-6><a id=__codelineno-16-6 name=__codelineno-16-6 href=#__codelineno-16-6></a><span class=w>    </span>rounds:
</span><span id=__span-16-7><a id=__codelineno-16-7 name=__codelineno-16-7 href=#__codelineno-16-7></a><span class=w>      </span>-<span class=w> </span>label:<span class=w> </span>readAsset
</span><span id=__span-16-8><a id=__codelineno-16-8 name=__codelineno-16-8 href=#__codelineno-16-8></a><span class=w>        </span>description:<span class=w> </span>Read<span class=w> </span>asset<span class=w> </span>benchmark
</span><span id=__span-16-9><a id=__codelineno-16-9 name=__codelineno-16-9 href=#__codelineno-16-9></a><span class=w>        </span>txDuration:<span class=w> </span><span class=m>30</span>
</span><span id=__span-16-10><a id=__codelineno-16-10 name=__codelineno-16-10 href=#__codelineno-16-10></a><span class=w>        </span>rateControl:
</span><span id=__span-16-11><a id=__codelineno-16-11 name=__codelineno-16-11 href=#__codelineno-16-11></a><span class=w>          </span>type:<span class=w> </span>fixed-load
</span><span id=__span-16-12><a id=__codelineno-16-12 name=__codelineno-16-12 href=#__codelineno-16-12></a><span class=w>          </span>opts:
</span><span id=__span-16-13><a id=__codelineno-16-13 name=__codelineno-16-13 href=#__codelineno-16-13></a><span class=w>            </span>transactionLoad:<span class=w> </span><span class=m>2</span>
</span><span id=__span-16-14><a id=__codelineno-16-14 name=__codelineno-16-14 href=#__codelineno-16-14></a><span class=w>        </span>workload:
</span><span id=__span-16-15><a id=__codelineno-16-15 name=__codelineno-16-15 href=#__codelineno-16-15></a><span class=w>          </span>module:<span class=w> </span>workload/readAsset.js
</span><span id=__span-16-16><a id=__codelineno-16-16 name=__codelineno-16-16 href=#__codelineno-16-16></a><span class=w>          </span>arguments:
</span><span id=__span-16-17><a id=__codelineno-16-17 name=__codelineno-16-17 href=#__codelineno-16-17></a><span class=w>            </span>assets:<span class=w> </span><span class=m>10</span>
</span><span id=__span-16-18><a id=__codelineno-16-18 name=__codelineno-16-18 href=#__codelineno-16-18></a><span class=w>            </span>contractId:<span class=w> </span>basic
</span></code></pre></div> <h2 id=step-5-run-the-caliper-benchmark>Step 5 - Run the Caliper Benchmark<a class=headerlink href=#step-5-run-the-caliper-benchmark title="Permanent link">&para;</a></h2> <p>We are now ready to run the performance benchmark using the above configuration files and test module. The performance benchmark will be run using the Caliper CLI, which will need to be supplied a path to the workspace and workspace relative paths to the network configuration file and the benchmark configuration file. This information is provided with the flags <code>--caliper-workspace</code>, <code>--caliper-networkconfig</code>, and <code>--caliper-benchconfig</code> respectively.</p> <p>Since the smart contract has already been installed and instantiated, Caliper only needs to perform the test phase. This is specified by using the flag <code>--caliper-flow-only-test</code>.</p> <h3 id=run-the-command>Run the command<a class=headerlink href=#run-the-command title="Permanent link">&para;</a></h3> <p>Ensure that you are in the <strong>caliper-workspace</strong> directory.</p> <p>In the terminal run the following Caliper CLI command:</p> <p><code>npx caliper launch manager --caliper-workspace ./ --caliper-networkconfig networks/networkConfig.yaml --caliper-benchconfig benchmarks/myAssetBenchmark.yaml --caliper-flow-only-test</code></p> <h3 id=benchmark-results>Benchmark Results<a class=headerlink href=#benchmark-results title="Permanent link">&para;</a></h3> <p>The resulting report will detail the following items for each benchmark round:</p> <ul> <li>Name - the round name from the benchmark configuration file</li> <li>Succ/Fail - the number of successful/failing transactions</li> <li>Send Rate - the rate at which caliper issued the transactions</li> <li>Latency (max/min/avg) - statistics relating to the time taken in seconds between issuing a transaction and receiving a response</li> <li>Throughput - the average number of transactions processed per second</li> </ul> <p>You have successfully benchmarked a smart contract. You can repeat the test varying the benchmark parameters, as well as adding resource monitors. For the full set of options, please refer to the <a href=../../ >Caliper Documentation</a></p> <h2 id=license>License<a class=headerlink href=#license title="Permanent link">&para;</a></h2> <p>The Caliper codebase is released under the <a href=../../getting-started/license/ >Apache 2.0 license</a>. Any documentation developed by the Caliper Project is licensed under the Creative Commons Attribution 4.0 International License. You may obtain a copy of the license, titled CC-BY-4.0, at <a href=http://creativecommons.org/licenses/by/4.0/ >http://creativecommons.org/licenses/by/4.0/</a>.</p> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../ class="md-footer__link md-footer__link--prev" aria-label="Previous: Tutorials"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Tutorials </div> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["announce.dismiss", "content.code.annotate", "content.code.copy", "content.tabs.link", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script> <script src=../../assets/javascripts/bundle.fe8b6f2b.min.js></script> </body> </html>